# {{ metadata.name|title }} Template

Template for scraping {{ metadata.site_domain }} using the Site Template Integration Framework.

## Overview

This template provides a complete implementation for scraping {{ metadata.site_domain }} with the following features:

- **Framework Integration**: Full integration with the Site Template Integration Framework
- **YAML Selectors**: Declarative selector definitions with multiple strategies
- **Component Integration**: Automatic integration with browser lifecycle, resource monitoring, and logging
- **Validation**: Comprehensive validation and error handling
- **Performance**: Optimized for performance with caching and monitoring

## Structure

```
{{ template_name }}/
├── __init__.py                 # Package initialization
├── scraper.py                  # Main scraper implementation
├── config.py                   # Configuration settings
├── flow.py                     # Navigation and interaction flows
├── integration_bridge.py       # Framework component integration
├── selector_loader.py          # YAML selector loading
├── selectors/                  # YAML selector definitions
│   ├── main_content.yaml
│   └── navigation.yaml
├── flows/                      # Flow implementations
│   └── main_flow.py
├── extraction/                 # Extraction rules and models
│   ├── __init__.py
│   ├── rules.py
│   └── models.py
├── tests/                      # Unit tests
│   ├── __init__.py
│   └── test_scraper.py
├── metadata.json               # Template metadata
└── README.md                  # This file
```

## Usage

### Basic Usage

```python
from src.sites.{{ template_name }}.scraper import {{ metadata.name|title }}Scraper

# Initialize scraper
scraper = {{ metadata.name|title }}Scraper(page, selector_engine)

# Initialize template components
await scraper.initialize()

# Scrape data
result = await scraper.scrape(
    action="scrape_main_content",
    limit=10
)
```

### Advanced Usage

```python
# Get template info
info = scraper.get_template_info()

# Check health status
health = await scraper.health_check()

# Capture screenshot
screenshot_path = await scraper.capture_{{ template_name }}_screenshot("context")

# Get performance metrics
metrics = scraper.get_performance_metrics()
```

## Configuration

The template can be configured through the `config.py` file:

```python
from src.sites.{{ template_name }}.config import get_config, update_config

# Get configuration
config = get_config()

# Update configuration
update_config("scraping", {"timeout": 60})
```

## Selectors

Selectors are defined in YAML files in the `selectors/` directory:

```yaml
name: main_content
description: Main content area selector
selector: .main-content
strategies:
  - name: css
    type: css
    priority: 1
    confidence: 0.9
validation:
  required: true
  exists: true
```

## Flows

Navigation and interaction flows are implemented in the `flows/` directory:

```python
from src.sites.base.template.flow import BaseFlow

class MainFlow(BaseFlow):
    async def execute(self, **kwargs):
        # Flow implementation
        pass
```

## Testing

Run tests with:

```bash
python -m pytest tests/sites/{{ template_name }}/
```

## Development

### Adding New Actions

1. Add action to `_execute_scrape_logic` method
2. Implement corresponding private method
3. Add tests for the new action

### Adding New Selectors

1. Create YAML file in `selectors/` directory
2. Define selector with strategies and validation
3. Test selector with validation tools

### Adding New Flows

1. Create flow file in `flows/` directory
2. Implement flow logic
3. Register flow in integration bridge

## Framework Integration

This template automatically integrates with:

- **Browser Lifecycle**: Screenshot and HTML capture
- **Resource Monitoring**: Memory and CPU tracking
- **Logging Integration**: Structured logging with correlation
- **Error Handling**: Comprehensive error tracking and recovery
- **Performance Monitoring**: Execution time and success rate tracking

## Security

The template includes security features:

- **Input Validation**: All inputs are validated
- **Access Control**: File and network access restrictions
- **Sandboxing**: Code execution in isolated environment
- **Audit Logging**: All actions are logged

## Performance

The template is optimized for performance:

- **Caching**: Selector and result caching
- **Lazy Loading**: Components loaded on demand
- **Resource Management**: Automatic cleanup and monitoring
- **Async Operations**: Non-blocking I/O throughout

## Troubleshooting

### Common Issues

1. **Import Errors**: Check that all dependencies are installed
2. **Selector Not Found**: Verify selector files exist and are valid YAML
3. **Initialization Errors**: Check configuration and dependencies
4. **Performance Issues**: Enable performance monitoring and check metrics

### Debug Mode

Enable debug mode for detailed logging:

```python
from src.sites.{{ template_name }}.config import update_config
update_config("development", {"debug_mode": True, "verbose_logging": True})
```

## Contributing

1. Follow the template structure
2. Add tests for new features
3. Update documentation
4. Validate with framework tools

## License

This template follows the same license as the Scorewise project.

## Support

For questions and issues:

- Check the documentation
- Review the test files
- Use the debugging tools
- Check framework logs

---

**Version**: {{ metadata.version }}  
**Author**: {{ metadata.author }}  
**Framework Version**: {{ metadata.framework_version }}  
**Last Updated**: {{ metadata.updated_at.strftime('%Y-%m-%d') }}
